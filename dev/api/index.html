<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · WeightedSampling.jl</title><meta name="title" content="API Reference · WeightedSampling.jl"/><meta property="og:title" content="API Reference · WeightedSampling.jl"/><meta property="twitter:title" content="API Reference · WeightedSampling.jl"/><meta name="description" content="Documentation for WeightedSampling.jl."/><meta property="og:description" content="Documentation for WeightedSampling.jl."/><meta property="twitter:description" content="Documentation for WeightedSampling.jl."/><meta property="og:url" content="https://MariusFurter.github.io/WeightedSampling.jl/api/"/><meta property="twitter:url" content="https://MariusFurter.github.io/WeightedSampling.jl/api/"/><link rel="canonical" href="https://MariusFurter.github.io/WeightedSampling.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WeightedSampling.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../usage_guide/">Usage Guide</a></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Core-Types"><span>Core Types</span></a></li><li><a class="tocitem" href="#The-@smc-macro"><span>The <code>@smc</code> macro</span></a></li><li><a class="tocitem" href="#Utility"><span>Utility</span></a></li><li><a class="tocitem" href="#MH-proposal-kernels"><span>MH proposal kernels</span></a></li><li><a class="tocitem" href="#Distribution-kernels"><span>Distribution kernels</span></a></li><li><a class="tocitem" href="#Advanced-usage"><span>Advanced usage</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MariusFurter/WeightedSampling.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/main/docs/src/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><h2 id="Core-Types"><a class="docs-heading-anchor" href="#Core-Types">Core Types</a><a id="Core-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WeightedSampling.SMCKernel" href="#WeightedSampling.SMCKernel"><code>WeightedSampling.SMCKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SMCKernel{S,L,W}</code></pre><p>Represents a (random weight) importance sampler.</p><p><strong>Fields</strong></p><ul><li><code>sampler::S</code>: Function <code>(args...) -&gt; sample</code> that generates samples</li><li><code>weighter::W</code>: Function <code>(args..., sample) -&gt; log_weight</code> that computes log weights. Can be random. Use <code>nothing</code> for uniform weights.</li><li><code>logpdf::L</code>: Function <code>(args..., sample) -&gt; log_density</code> that evaluates log-density</li></ul><p>Every <code>SMCKernel</code> represents a stochastic kernel given by averaging samples over weights:</p><p class="math-container">\[\int_{w} \text{weighter}(w \mid \text{args}, x) \text{sampler}(x \mid \text{args}) dw\]</p><p>The <code>logpdf</code> function is the density of this kernel.</p><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">SMCKernel(sampler, weighter, logpdf)</code></pre><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using Distributions

# Custom truncated normal kernel
TruncatedNormal = SMCKernel(
    (μ, σ, a, b) -&gt; rand(Truncated(Normal(μ, σ), a, b)),
    nothing,  # uniform weights
    (μ, σ, a, b, x) -&gt; logpdf(Truncated(Normal(μ, σ), a, b), x)
)

# Use in @smc model
@smc function model(data)
    θ ~ TruncatedNormal(0.0, 1.0, -2.0, 2.0)
    for y in data
        y =&gt; Normal(θ, 0.5)
    end
end</code></pre><p>See also: <a href="#WeightedSampling.@smc"><code>@smc</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/dda68f30f0b52dc5939c9f73b6c103259452246d/src/smc_kernels.jl#L1-L43">source</a></section></article><h2 id="The-@smc-macro"><a class="docs-heading-anchor" href="#The-@smc-macro">The <code>@smc</code> macro</a><a id="The-@smc-macro-1"></a><a class="docs-heading-anchor-permalink" href="#The-@smc-macro" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WeightedSampling.@smc" href="#WeightedSampling.@smc"><code>WeightedSampling.@smc</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@smc function model(args...)
    # probabilistic program
end</code></pre><p>Transform a Julia function into an SMC sampler.</p><p><strong>Generated Functions</strong></p><p>The macro generates two functions:</p><ul><li><code>model(args...; n_particles=1000, ...)</code>: Creates new particles and returns <code>(particles, evidence)</code></li><li><code>model!(args...; particles, ...)</code>: Updates existing particles in-place and returns evidence</li></ul><p>where</p><ul><li><code>args...</code>: Model-specific arguments (data, hyperparameters, etc.)</li><li><code>n_particles::Int=1000</code>: Number of particles to create</li><li><code>particles::DataFrame</code>: Existing particle DataFrame to update in-place</li></ul><p>Both functions accept the following keyword arguments:</p><ul><li><code>ess_perc_min::Float64=0.5</code>: Minimum effective sample size percentage for resampling trigger</li><li><code>kernels::NamedTuple=nothing</code>: Custom SMC kernels (merged with defaults)</li><li><code>proposals::NamedTuple=nothing</code>: Custom proposal kernels for MH moves (merged with defaults)</li><li><code>compute_evidence::Bool=true</code>: Whether to compute evidence (log marginal likelihood)</li><li><code>show_progress::Bool=true</code>: Whether to show progress bar</li></ul><p><strong>Operators</strong></p><p>Within <code>@smc</code>, the following operators are available:</p><ul><li><strong>Particle assignment:</strong> <code>x .= expr</code> broadcasts <code>expr</code> to <code>particles.x</code>.</li><li><strong>Sampling:</strong> <code>x ~ SMCKernel(args)</code> samples to <code>particles.x</code> and updates weights.</li><li><strong>Observation:</strong> <code>expr =&gt; SMCKernel(args)</code> updates weights based on observing <code>expr</code>.</li><li><strong>MH Move:</strong> <code>x &lt;&lt; Proposal(args)</code> performs Metropolis-Hastings moves on <code>particles.x</code>.</li></ul><p>Both <code>expr</code> and <code>args</code> can reference <code>particles.x</code> as <code>x</code>.</p><p>Regular Julia constructs are supported:</p><ul><li><strong>Assignment <code>=</code>:</strong> Creates local variables (not stored in <code>particles</code>).</li><li><strong>For loops:</strong> Supports <code>for i in collection</code> and tuple destructuring, where <code>collection</code> does not involve particle variables.</li><li><strong>Conditionals:</strong> <code>if condition</code> where <code>condition</code> does not involve particle variables.</li></ul><p>Additional features:</p><ul><li><strong>Array indexing:</strong> <code>x[i]</code> maps over <code>particles.x</code>.</li><li><strong>Index interpolation:</strong> <code>x{i}</code> creates dynamic variable names (e.g., <code>x1</code>, <code>x2</code>, ...).</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Linear regression with moves
@smc function linear_regression(xs, ys)
    α ~ Normal(0, 10)
    β ~ Normal(0, 10)
    for (x, y) in zip(xs, ys)
        y =&gt; Normal(α + β * x, 1.0)
        if resampled
            (α, β) &lt;&lt; autoRW()
        end
    end
end

xs = 1:10
ys = 1-0 .- 0.5 .* xs .+ 0.5 * randn(length(xs))

particles, evidence = linear_regression(xs, ys, n_particles=1000, ess_perc_min=0.5)
describe_particles(particles)</code></pre><p>See also: <a href="#WeightedSampling.SMCKernel"><code>SMCKernel</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/dda68f30f0b52dc5939c9f73b6c103259452246d/src/rewrites.jl#L338-L408">source</a></section></article><h2 id="Utility"><a class="docs-heading-anchor" href="#Utility">Utility</a><a id="Utility-1"></a><a class="docs-heading-anchor-permalink" href="#Utility" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WeightedSampling.@E" href="#WeightedSampling.@E"><code>WeightedSampling.@E</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@E(f, particles)</code></pre><p>Compute the weighted expectation of an anonymous function <code>f</code> with respect to particle samples.</p><p><strong>Arguments</strong></p><ul><li><code>f</code>: Anonymous function where argument names reference particle column names</li><li><code>particles</code>: DataFrame with particle samples and <code>:weights</code> column</li></ul><p><strong>Returns</strong></p><p>Weighted expectation <span>$\mathbb{E}[f] = \sum_{i=1}^N w_i f(x p_i)$</span>, where <span>$w_i$</span> are normalized particle weights.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Expectation of `particles.x`
posterior_mean = @E(x -&gt; x, particles)

# Expectation of `sin.(particles.x) + cos.(particles.y)`
expectation = @E((x,y) -&gt; sin(x) + cos(y), particles)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/dda68f30f0b52dc5939c9f73b6c103259452246d/src/utils.jl#L38-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WeightedSampling.exp_norm" href="#WeightedSampling.exp_norm"><code>WeightedSampling.exp_norm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exp_norm(weights::Vector{Float64})</code></pre><p>Exponentiate and normalize log weights.</p><p><strong>Arguments</strong></p><ul><li><code>weights::Vector{Float64}</code>: Vector of log weights.</li></ul><p><strong>Returns</strong></p><p>Vector of normalized probabilities.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">exp_norm(particles.weights)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/dda68f30f0b52dc5939c9f73b6c103259452246d/src/utils.jl#L12-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WeightedSampling.describe_particles" href="#WeightedSampling.describe_particles"><code>WeightedSampling.describe_particles</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">describe_particles(particles::DataFrame; cols=nothing)</code></pre><p>Compute weighted descriptive statistics for particle variables.</p><p><strong>Arguments</strong></p><ul><li><code>particles::DataFrame</code>: DataFrame with particle samples and <code>:weights</code> column containing log weights</li><li><code>cols=nothing</code>: Vector of column names to analyze (default: all numeric columns except <code>:weights</code>)</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>variable::Symbol</code>: Variable name  </li><li><code>mean</code>: Weighted mean (scalar or vector)</li><li><code>median</code>: Weighted median (scalar or vector)</li><li><code>std</code>: Weighted standard deviation (scalar or vector)</li><li><code>min</code>: Minimum value (scalar or vector)</li><li><code>max</code>: Maximum value (scalar or vector) </li><li><code>ess::Float64</code>: Effective sample size <span>$\text{ESS} = \frac{1}{\sum_{i=1}^N w_i^2}$</span></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">describe_particles(particles)</code></pre><p>The function handles both scalar and vector-valued particle variables. For vector variables, statistics are computed component-wise and returned as vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/dda68f30f0b52dc5939c9f73b6c103259452246d/src/utils.jl#L163-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WeightedSampling.sample_particles" href="#WeightedSampling.sample_particles"><code>WeightedSampling.sample_particles</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sample_particles(particles::DataFrame, n::Int; replace::Bool=true)</code></pre><p>Randomly sample <code>n</code> rows from a DataFrame of weighted particles according to their log weights.</p><p><strong>Arguments</strong></p><ul><li><code>particles::DataFrame</code>: DataFrame with particle samples and <code>:weights</code> column containing log weights</li><li><code>n::Int</code>: Number of samples to draw</li><li><code>replace::Bool=true</code>: Whether to sample with replacement</li></ul><p><strong>Returns</strong></p><p>DataFrame with <code>n</code> sampled particles.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">posterior_samples = sample_particles(particles, 1000)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/dda68f30f0b52dc5939c9f73b6c103259452246d/src/utils.jl#L124-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WeightedSampling.diversity" href="#WeightedSampling.diversity"><code>WeightedSampling.diversity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diversity(particles, targets)</code></pre><p>Compute particle diversity as the fraction of unique particle combinations.</p><p><strong>Arguments</strong></p><ul><li><code>particles::DataFrame</code>: DataFrame with particle samples</li><li><code>targets</code>: Vector of column names to consider for diversity calculation</li></ul><p><strong>Returns</strong></p><p>Float64 between 0 and 1, where:</p><ul><li>1.0 = all particles in subset are unique</li><li>0.0 = all particles in subset are identical</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Conditional move based on diversity
if diversity(particles, [:x]) &lt; 0.5
    x &lt;&lt; autoRW()
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/dda68f30f0b52dc5939c9f73b6c103259452246d/src/moves.jl#L123-L145">source</a></section></article><h2 id="MH-proposal-kernels"><a class="docs-heading-anchor" href="#MH-proposal-kernels">MH proposal kernels</a><a id="MH-proposal-kernels-1"></a><a class="docs-heading-anchor-permalink" href="#MH-proposal-kernels" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WeightedSampling.autoRW" href="#WeightedSampling.autoRW"><code>WeightedSampling.autoRW</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">autoRW(particles, targets, min_step=1e-3)</code></pre><p>Adaptive random walk proposal kernel with empirically calibrated covariance.</p><p><strong>Arguments</strong></p><ul><li><code>particles::DataFrame</code>: Current particle set  </li><li><code>targets::Vector{Symbol}</code>: Variable names to update</li><li><code>min_step=1e-3</code>: Minimum step size to prevent singular covariance</li></ul><p><strong>Returns</strong></p><ul><li><code>proposals::DataFrame</code>: Proposed new values for target variables</li><li><code>log_ratios::Vector{Float64}</code>: Log proposal ratios (zero since proposal is symmetric)</li></ul><p><strong>Description</strong></p><p>Performs adaptive random walk using the empirical covariance of target particles:</p><p class="math-container">\[x^{\text{new}} = x^{\text{old}} + \epsilon, \quad \epsilon \sim \mathcal{N}(0, \lambda \Sigma)\]</p><p>where:</p><ul><li><span>$\lambda = 2.38 d^(-1/2)$</span> is the optimal scaling factor for <span>$d$</span>-dimensional problems</li><li><span>$\Sigma$</span> is the weighted empirical covariance matrix of the target particles</li><li>Covariance elements are replaced with <code>min_step</code> if they are zero</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">@smc function model()
    α ~ Normal(0, 10)
    β ~ Normal(0, 10)
    
    α &lt;&lt; autoRW()
    (α, β) &lt;&lt; autoRW()
end</code></pre><p>See also: <a href="#WeightedSampling.@smc"><code>@smc</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/dda68f30f0b52dc5939c9f73b6c103259452246d/src/move_kernels.jl#L48-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WeightedSampling.RW" href="#WeightedSampling.RW"><code>WeightedSampling.RW</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RW(particles, targets, step_size)</code></pre><p>Symmetric random walk proposal kernel with variance <code>step_size</code>.</p><p><strong>Arguments</strong></p><ul><li><code>particles::DataFrame</code>: Current particle set</li><li><code>targets::Vector{Symbol}</code>: Variable names to update</li><li><code>step_size</code>: Step size for random walk</li></ul><p><strong>Returns</strong></p><ul><li><code>proposals::DataFrame</code>: Proposed new values for target variables</li><li><code>log_ratios::Vector{Float64}</code>: Log proposal ratios (zero since proposal is symmetric)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">@smc function model()
    α ~ Normal(0, 10)
    β ~ Normal(0, 10)
    
    α &lt;&lt; RW(0.1)
    (α, β) &lt;&lt; RW(0.1)
end</code></pre><p>See also: <a href="#WeightedSampling.@smc"><code>@smc</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MariusFurter/WeightedSampling.jl/blob/dda68f30f0b52dc5939c9f73b6c103259452246d/src/move_kernels.jl#L1-L27">source</a></section></article><h2 id="Distribution-kernels"><a class="docs-heading-anchor" href="#Distribution-kernels">Distribution kernels</a><a id="Distribution-kernels-1"></a><a class="docs-heading-anchor-permalink" href="#Distribution-kernels" title="Permalink"></a></h2><p>WeightedSampling.jl provides kernels for all major distributions from Distributions.jl. These can be used directly by name in <code>@smc</code> functions:</p><h3 id="Continuous-distributions"><a class="docs-heading-anchor" href="#Continuous-distributions">Continuous distributions</a><a id="Continuous-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Continuous-distributions" title="Permalink"></a></h3><p><code>Normal(μ, σ)</code>, <code>Beta(α, β)</code>, <code>Gamma(α, θ)</code>, <code>Exponential(θ)</code>, <code>Uniform(a, b)</code>, <code>Cauchy(μ, σ)</code>, <code>Laplace(α, θ)</code>, <code>LogNormal(μ, σ)</code>, <code>Weibull(α, θ)</code>, <code>Chi(ν)</code>, <code>Chisq(ν)</code>, <code>TDist(ν)</code>, <code>FDist(ν1, ν2)</code>, <code>Pareto(α, θ)</code>, <code>Rayleigh(σ)</code>, <code>Gumbel(μ, θ)</code>, <code>Frechet(α, θ)</code>, <code>InverseGamma(α, θ)</code>, <code>LogitNormal(μ, σ)</code>, <code>Logistic(μ, θ)</code>, <code>SkewNormal(ξ, ω, α)</code>, <code>SkewedExponentialPower(μ, σ, p, α)</code>, <code>VonMises(μ, κ)</code>, <code>GeneralizedPareto(μ, σ, ξ)</code>, <code>NoncentralChisq(ν, λ)</code>, <code>NoncentralF(ν1, ν2, λ)</code>, <code>NoncentralT(ν, λ)</code>, <code>NormalCanon(η, λ)</code></p><h3 id="Discrete-distributions"><a class="docs-heading-anchor" href="#Discrete-distributions">Discrete distributions</a><a id="Discrete-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-distributions" title="Permalink"></a></h3><p><code>Bernoulli(p)</code>, <code>BernoulliLogit(logitp)</code>, <code>Binomial(n, p)</code>, <code>BetaBinomial(n, α, β)</code>, <code>Categorical(p)</code>, <code>DiscreteUniform(a, b)</code>, <code>Geometric(p)</code>, <code>Hypergeometric(s, f, n)</code>, <code>NegativeBinomial(r, p)</code>, <code>Poisson(λ)</code>, <code>PoissonBinomial(p)</code>, <code>DiscreteNonParametric(xs, ps)</code>, <code>Dirac(x)</code></p><h3 id="Multivariate-distributions"><a class="docs-heading-anchor" href="#Multivariate-distributions">Multivariate distributions</a><a id="Multivariate-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Multivariate-distributions" title="Permalink"></a></h3><p><code>MvNormal(μ, Σ)</code>, <code>MvNormalCanon(h, J)</code>, <code>MvLogNormal(μ, Σ)</code>, <code>MvLogitNormal(μ, Σ)</code>, <code>Multinomial(n, p)</code>, <code>Dirichlet(α)</code>, <code>LKJ(d, η)</code>, <code>LKJCholesky(d, η)</code>, <code>Wishart(ν, S)</code>, <code>InverseWishart(ν, Ψ)</code></p><h3 id="Matrix-valued-distributions"><a class="docs-heading-anchor" href="#Matrix-valued-distributions">Matrix-valued distributions</a><a id="Matrix-valued-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Matrix-valued-distributions" title="Permalink"></a></h3><p><code>MatrixNormal(M, U, V)</code>, <code>MatrixBeta(p, n1, n2)</code>, <code>MatrixFDist(n1, n2, B)</code>, <code>MatrixTDist(ν, M, Σ, Ω)</code></p><h2 id="Advanced-usage"><a class="docs-heading-anchor" href="#Advanced-usage">Advanced usage</a><a id="Advanced-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-usage" title="Permalink"></a></h2><h3 id="Custom-kernels"><a class="docs-heading-anchor" href="#Custom-kernels">Custom kernels</a><a id="Custom-kernels-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-kernels" title="Permalink"></a></h3><p>You can define custom SMC kernels for distributions not included in the package:</p><pre><code class="language-julia hljs">using Distributions

# Custom truncated normal kernel
TruncatedNormal = SMCKernel(
    (μ, σ, a, b) -&gt; rand(Truncated(Normal(μ, σ), a, b)),
    nothing,  # uniform weights
    (μ, σ, a, b, x) -&gt; logpdf(Truncated(Normal(μ, σ), a, b), x)
)

@smc function model()
    θ ~ TruncatedNormal(0.0, 1.0, -2.0, 2.0)
end

# Pass custom kernel to the model
particles, evidence = model(
    kernels=(TruncatedNormal=TruncatedNormal,)
)</code></pre><h3 id="Custom-proposals"><a class="docs-heading-anchor" href="#Custom-proposals">Custom proposals</a><a id="Custom-proposals-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-proposals" title="Permalink"></a></h3><p>You can defined custom MH proposals using the following signature:</p><pre><code class="language-julia hljs">function Proposal(particles, targets, params...)
    # Return (proposed_changes::DataFrame, log_ratios::Vector)
end</code></pre><p>Here <code>log_ratios</code> is a vector with entries <span>$\log q(x_\text{old} \mid x_\text{new}) - \log q(x_\text{new} \mid x_\text{old})$</span>, where <span>$q$</span> is the density of the proposal kernel.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage_guide/">« Usage Guide</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 3 October 2025 07:28">Friday 3 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
